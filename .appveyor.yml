environment:
  matrix:
  - PYTHON: "C:\\Python35"
  - PYTHON: "C:\\Python35-x64"
  - PYTHON: "C:\\Python36"
  - PYTHON: "C:\\Python36-x64"

services:
- postgresql

install:
# Turn on UTF-8 encoding in the terminal
# Ref: https://stackoverflow.com/a/32383309/595220
- chcp 65001

# Ensure the Git Submoduldes have been pulled down too
- git submodule update --init --recursive

- "%PYTHON%\\python.exe -m pip install -U pip wheel setuptools . -r tests/requirements.txt"

build_script:
- "%PYTHON%\\Scripts\\grablib.exe"
- "%PYTHON%\\python.exe -m setup sdist bdist_wheel"

test_script:
- "%PYTHON%\\python.exe -m setup check -rms"
- "%PYTHON%\\python.exe -m pytest --cov=aiohttp_devtools --boxed --duration 5"

artifacts:
- path: dist\*
